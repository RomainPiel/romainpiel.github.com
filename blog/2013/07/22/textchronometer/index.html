
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>TextChronometer - live 'time ago' TextView - Anything About Android</title>
	<meta name="author" content="Romain Piel">

	
	<meta name="description" content="The other day I was using Twitter for Android and I noticed something that we can call a bug. Timestamps in the timeline don&rsquo;t get updated &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Anything About Android" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Anything About Android</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:RomainPiel.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/_rpiel" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/romainpiel" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0" placeholder="Search">
		<input type="hidden" name="q" value="site:RomainPiel.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">TextChronometer - Live 'Time Ago' TextView</h2>
	<div class="entry-content"><p>The other day I was using Twitter for Android and I noticed something that we can call a bug. Timestamps in the timeline don&rsquo;t get updated until the list view gets scrolled. If you are an Android developer, you know that this behaviour is expected. Views will only get updated when the adapter calls getView() and the view is getting populated.</p>

<p><img src="http://d.pr/i/7beE+" alt="Twitter example" /></p>

<p>But obviously this is wrong. If I browse my timeline, then let my screen on and get back to it after one hour, I don&rsquo;t want to see the same time.</p>

<p>The reason why developers don&rsquo;t bother is mainly because the SDK doesn&rsquo;t offer any solution with this exact purpose.
&ndash; DigitalClock (or its new version, TextClock) are designed to display a simple clock. TextClock can have different formats of date but the &ldquo;ago&rdquo; form is not one of them.
&ndash; Chronometer could be enough but we&rsquo;d still have to tweak it to have a nice result.</p>

<p><a href="https://github.com/RomainPiel/TextChronometer">Here is my solution</a>. I bet it&rsquo;s not perfect but it does the job. The custom view is called <a href="https://github.com/RomainPiel/TextChronometer/blob/master/TextChronometer/src/main/java/com/romainpiel/textchronometer/TextChronometer.java">TextChronometer</a> (I may want to change that name in the future). Just include it in your layout:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;com.romainpiel.textchronometer.TextChronometer</span>
</span><span class='line'>     <span class="na">android:id=</span><span class="s">&quot;@+id/timestamp&quot;</span>
</span><span class='line'>     <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>     <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span><span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then to set it up:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">textChronometer</span><span class="o">.</span><span class="na">setTime</span><span class="o">(</span><span class="n">timeInMillis</span><span class="o">);</span>    
</span></code></pre></td></tr></table></div></figure>


<p>I&rsquo;m providing a <a href="https://github.com/RomainPiel/TextChronometer/tree/master/TextChronometer-sample">sample</a> showing how to use it in an adapter (nothing really fancy in there).</p>

<p><img src="http://d.pr/i/J16b+" alt="TextChronometer sample ListActivity" /></p>

<p>Current state of the project is very basic and I imagine it can be improved a lot. If you have any suggestion, feel free to contribute.</p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-22T17:45:00+02:00" pubdate data-updated="true">Jul 22<span>nd</span>, 2013</time></div>
	<div class="tags">

</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Romain Piel

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>